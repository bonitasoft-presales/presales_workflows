name: test_run_datagen
on:
  workflow_dispatch:

jobs:
  prerequisites:
    uses: ./.github/workflows/reusable_prerequisites.yml

  create_server:
    uses: ./.github/workflows/reusable_create_server.yml
    secrets: inherit

  build_sca:
    needs: [prerequisites, create_server]
    uses: ./.github/workflows/reusable_build_sca.yml
    secrets: inherit

  deploy_sca:
    needs: build_sca
    uses: ./.github/workflows/reusable_deploy_sca.yml
    secrets: inherit

  run_datagen:
    needs: deploy_sca
    uses: ./.github/workflows/reusable_run_datagen.yml
    # Inputs (all optional):
    #   datagen_folder: "datagen" (default)
    #   bonita_dns: defaults to AWS instance DNS
    #   bonita_port: "8081" (default)
    #   smtp_server: "greenmail" (default)
    #   smtp_port: "3025" (default)
    # Secrets (SF_USERNAME, SF_PASSWORD, SF_TOKEN are optional Salesforce credentials)
    secrets: inherit
