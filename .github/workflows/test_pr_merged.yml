name: Test PR Merged

on:
  workflow_dispatch:
    inputs:
      repository_name:
        description: 'Repository name (e.g., owner/repo)'
        required: false
        type: string
        default: 'bonitasoft-presales/presales-BPM-Template'
      pr_number:
        description: 'PR number'
        required: false
        type: number
        default: 57
      pr_title:
        description: 'PR title'
        required: false
        type: string
        default: 'Test PR for merge workflow'
      pr_merged:
        description: 'Whether the PR was merged'
        required: false
        type: boolean
        default: true
      pr_base_ref:
        description: 'Base branch'
        required: false
        type: string
        default: 'main'
      pr_head_ref:
        description: 'Head branch'
        required: false
        type: string
        default: 'feature/test-branch'
      pr_actor_login:
        description: 'User who merged or closed the PR'
        required: false
        type: string
        default: 'test-user'
      pr_merge_commit_sha:
        description: 'Merge commit SHA (empty if not merged)'
        required: false
        type: string
        default: 'abc123def456'

jobs:
  handle_pr_closed:
    uses: ./.github/workflows/reusable_pr_closed.yml
    with:
      repository_name: ${{ github.event.inputs.repository_name || 'bonitasoft-presales/presales-BPM-Template' }}
      pr_number: ${{ fromJSON(github.event.inputs.pr_number || '57') }}
      pr_title: ${{ github.event.inputs.pr_title || 'Test PR for merge workflow' }}
      pr_merged: ${{ fromJSON(github.event.inputs.pr_merged || 'true') }}
      pr_base_ref: ${{ github.event.inputs.pr_base_ref || 'main' }}
      pr_head_ref: ${{ github.event.inputs.pr_head_ref || 'feature/test-branch' }}
      pr_actor_login: ${{ github.event.inputs.pr_actor_login || 'test-user' }}
      pr_merge_commit_sha: ${{ github.event.inputs.pr_merge_commit_sha || 'abc123def456' }}
    secrets: inherit
